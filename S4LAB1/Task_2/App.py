from Book import Book
from PyQt5.QtWidgets import (QMainWindow, QLabel, QScrollArea, QVBoxLayout, QFrame, QWidget,
                             QHBoxLayout)  # –ò–º–ø–æ—Ä—Ç–∏—Ä—É–µ–º –≤–∏–¥–∂–µ—Ç—ã PyQt5
from PyQt5.QtGui import QPixmap  # –ò–º–ø–æ—Ä—Ç–∏—Ä—É–µ–º QPixmap –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –∫–∞—Ä—Ç–∏–Ω–∫–∞–º–∏
from PyQt5.QtCore import Qt  # –ò–º–ø–æ—Ä—Ç–∏—Ä—É–µ–º Qt –¥–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è —Ñ–ª–∞–≥–æ–≤ (–Ω–∞–ø—Ä–∏–º–µ—Ä, –≤—ã—Ä–∞–≤–Ω–∏–≤–∞–Ω–∏–µ)

books = [
    Book("–ì–∞—Ä—Ä–∏ –ü–æ—Ç—Ç–µ—Ä –∏ –ø—Ä–æ–∫–ª—è—Ç—ã–π –∫–æ–¥", "–î–∂.–ö. –†–æ—É–ª–∏–Ω–≥", 404, "../covers/tupa_ya.jpg"),
    Book("–ö–∞–∫ –≤—ã–∂–∏—Ç—å –≤ –ë—Ä–∞–≥–∏–Ω–æ", "–ß–∞–∫ –ù–æ—Ä–∏—Å", 9999, "../covers/brzd.jpg")
]


# –°–æ–∑–¥–∞–µ–º –∫–ª–∞—Å—Å BookApp, –∫–æ—Ç–æ—Ä—ã–π –Ω–∞—Å–ª–µ–¥—É–µ—Ç—Å—è –æ—Ç QWidget (–±–∞–∑–æ–≤—ã–π –≤–∏–¥–∂–µ—Ç PyQt5)
class BookApp(QWidget):
    def __init__(self):
        super().__init__()  # –í—ã–∑—ã–≤–∞–µ–º –∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä —Ä–æ–¥–∏—Ç–µ–ª—å—Å–∫–æ–≥–æ –∫–ª–∞—Å—Å–∞ (QWidget)
        self.initUI()  # –í—ã–∑—ã–≤–∞–µ–º –º–µ—Ç–æ–¥ –¥–ª—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞

    def initUI(self):
        # –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –æ–∫–Ω–∞
        self.setWindowTitle('–ö–Ω–∏–∂–Ω—ã–π —á–µ—Ä—Ç–æ–≥ PyQt')  # –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –∑–∞–≥–æ–ª–æ–≤–æ–∫ –æ–∫–Ω–∞
        self.setGeometry(300, 300, 600, 400)  # –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Ä–∞–∑–º–µ—Ä –∏ –ø–æ–ª–æ–∂–µ–Ω–∏–µ –æ–∫–Ω–∞ (x, y, width, height)

        # –°–æ–∑–¥–∞–µ–º –ø—Ä–æ–∫—Ä—É—á–∏–≤–∞–µ–º—É—é –æ–±–ª–∞—Å—Ç—å (QScrollArea)
        scroll = QScrollArea()
        scroll.setWidgetResizable(True)  # –†–∞–∑—Ä–µ—à–∞–µ–º –∏–∑–º–µ–Ω–µ–Ω–∏–µ —Ä–∞–∑–º–µ—Ä–∞ —Å–æ–¥–µ—Ä–∂–∏–º–æ–≥–æ

        # –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä –¥–ª—è –≤—Å–µ—Ö –∫–Ω–∏–≥ (QWidget)
        container = QWidget()
        self.vbox = QVBoxLayout(container)  # –°–æ–∑–¥–∞–µ–º –≤–µ—Ä—Ç–∏–∫–∞–ª—å–Ω—ã–π –ª–µ–π–∞—É—Ç –¥–ª—è –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞

        # –î–ª—è –∫–∞–∂–¥–æ–π –∫–Ω–∏–≥–∏ —Å–æ–∑–¥–∞–µ–º —Å–≤–æ–π –≤–∏–¥–∂–µ—Ç
        for book in books:
            self.add_book_widget(book)

        # –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º –ø—Ä–æ–∫—Ä—É—Ç–∫—É
        scroll.setWidget(container)  # –ü–æ–º–µ—â–∞–µ–º –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –≤ –ø—Ä–æ–∫—Ä—É—á–∏–≤–∞–µ–º—É—é –æ–±–ª–∞—Å—Ç—å

        # –ì–ª–∞–≤–Ω—ã–π –ª–µ–π–∞—É—Ç (QVBoxLayout)
        main_layout = QVBoxLayout(self)  # –°–æ–∑–¥–∞–µ–º –≤–µ—Ä—Ç–∏–∫–∞–ª—å–Ω—ã–π –ª–µ–π–∞—É—Ç –¥–ª—è –≥–ª–∞–≤–Ω–æ–≥–æ –æ–∫–Ω–∞
        main_layout.addWidget(scroll)  # –î–æ–±–∞–≤–ª—è–µ–º –ø—Ä–æ–∫—Ä—É—á–∏–≤–∞–µ–º—É—é –æ–±–ª–∞—Å—Ç—å –≤ –≥–ª–∞–≤–Ω—ã–π –ª–µ–π–∞—É—Ç

    def add_book_widget(self, book):
        # –°–æ–∑–¥–∞–µ–º —Ñ—Ä–µ–π–º –¥–ª—è –∫–Ω–∏–≥–∏ (QFrame)
        frame = QFrame()
        frame.setFrameShape(QFrame.StyledPanel)  # –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Å—Ç–∏–ª—å —Ä–∞–º–∫–∏ (StyledPanel ‚Äî –∫—Ä–∞—Å–∏–≤–∞—è —Ä–∞–º–∫–∞)
        frame.setFixedHeight(200)  # –§–∏–∫—Å–∏—Ä—É–µ–º –≤—ã—Å–æ—Ç—É —Ñ—Ä–µ–π–º–∞ (200 –ø–∏–∫—Å–µ–ª–µ–π)

        # –°–æ–∑–¥–∞–µ–º –≥–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω—ã–π –ª–µ–π–∞—É—Ç –¥–ª—è —Ñ—Ä–µ–π–º–∞ (QHBoxLayout)
        layout = QHBoxLayout(frame)

        # –ó–∞–≥—Ä—É–∑–∫–∞ –æ–±–ª–æ–∂–∫–∏ –∫–Ω–∏–≥–∏
        try:
            pixmap = QPixmap(book.cover_path)  # –ó–∞–≥—Ä—É–∂–∞–µ–º –∫–∞—Ä—Ç–∏–Ω–∫—É –ø–æ —É–∫–∞–∑–∞–Ω–Ω–æ–º—É –ø—É—Ç–∏
            if not pixmap.isNull():  # –ü—Ä–æ–≤–µ—Ä—è–µ–º, —á—Ç–æ –∫–∞—Ä—Ç–∏–Ω–∫–∞ –∑–∞–≥—Ä—É–∑–∏–ª–∞—Å—å
                pixmap = pixmap.scaled(150, 200,
                                       Qt.KeepAspectRatio)  # –ú–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º –∫–∞—Ä—Ç–∏–Ω–∫—É (150x200, —Å–æ—Ö—Ä–∞–Ω—è—è –ø—Ä–æ–ø–æ—Ä—Ü–∏–∏)
                cover_label = QLabel()  # –°–æ–∑–¥–∞–µ–º QLabel –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –∫–∞—Ä—Ç–∏–Ω–∫–∏
                cover_label.setPixmap(pixmap)  # –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –∫–∞—Ä—Ç–∏–Ω–∫—É –≤ QLabel
                layout.addWidget(cover_label)  # –î–æ–±–∞–≤–ª—è–µ–º QLabel –≤ –ª–µ–π–∞—É—Ç
            else:
                raise FileNotFoundError  # –ï—Å–ª–∏ –∫–∞—Ä—Ç–∏–Ω–∫–∞ –Ω–µ –∑–∞–≥—Ä—É–∑–∏–ª–∞—Å—å, –≤—ã–±—Ä–∞—Å—ã–≤–∞–µ–º –æ—à–∏–±–∫—É
        except:
            error_label = QLabel("üò° –û–±–ª–æ–∂–∫–∞ —Å–≥–æ—Ä–µ–ª–∞ –≤ –∞–¥—É!")  # –°–æ–∑–¥–∞–µ–º QLabel —Å —Å–æ–æ–±—â–µ–Ω–∏–µ–º –æ–± –æ—à–∏–±–∫–µ
            layout.addWidget(error_label)  # –î–æ–±–∞–≤–ª—è–µ–º QLabel –≤ –ª–µ–π–∞—É—Ç

        # –°–æ–∑–¥–∞–µ–º QLabel –¥–ª—è —Ç–µ–∫—Å—Ç–∞ —Å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π –æ –∫–Ω–∏–≥–µ
        info_label = QLabel(book.get_info())  # –ò—Å–ø–æ–ª—å–∑—É–µ–º –º–µ—Ç–æ–¥ get_info() –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è —Ç–µ–∫—Å—Ç–∞
        info_label.setAlignment(Qt.AlignTop)  # –í—ã—Ä–∞–≤–Ω–∏–≤–∞–µ–º —Ç–µ–∫—Å—Ç –ø–æ –≤–µ—Ä—Ö–Ω–µ–º—É –∫—Ä–∞—é
        info_label.setStyleSheet("font-size: 14px;")  # –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Å—Ç–∏–ª—å —Ç–µ–∫—Å—Ç–∞ (—Ä–∞–∑–º–µ—Ä —à—Ä–∏—Ñ—Ç–∞ 14px)
        layout.addWidget(info_label)  # –î–æ–±–∞–≤–ª—è–µ–º QLabel –≤ –ª–µ–π–∞—É—Ç

        # –î–æ–±–∞–≤–ª—è–µ–º —Ñ—Ä–µ–π–º –≤ –æ–±—â–∏–π –≤–µ—Ä—Ç–∏–∫–∞–ª—å–Ω—ã–π –ª–µ–π–∞—É—Ç
        self.vbox.addWidget(frame)

